{"ast":null,"code":"import _regeneratorRuntime from \"/Users/Neil/Projects/xkcd-geohashing/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/Neil/Projects/xkcd-geohashing/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport axios from 'axios';\nimport moment from 'moment';\nimport _ from 'lodash';\nexport function getDOW(_x) {\n  return _getDOW.apply(this, arguments);\n}\n\nfunction _getDOW() {\n  _getDOW = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(date) {\n    var endDate, today, daysBetween, options, result, DJIAdata, searchDate, dowOpening;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            // to adjust for different dates, the outputsize value needs to be adjusted accordingly.\n            // new code uses the twelvedata API server, which provides all the information I need\n            // plus I have rapidapi taking care of the overhead, which is nice\n            endDate = moment(date);\n            today = moment().format('YYYY-MM-DD');\n            daysBetween = -1 * startDate.diff(today, \"days\") + 1;\n            console.log(daysBetween);\n            options = {\n              method: 'GET',\n              url: 'https://twelve-data1.p.rapidapi.com/time_series',\n              params: {\n                symbol: 'DJI',\n                interval: '1day',\n                outputsize: daysBetween,\n                format: 'json'\n              },\n              headers: {\n                'x-rapidapi-key': 'cc072cf6a1mshca7a9fff5bd7131p175ba7jsne97460d453d2',\n                'x-rapidapi-host': 'twelve-data1.p.rapidapi.com'\n              }\n            };\n            console.log('checking the past ' + options.params.outputsize + ' days');\n            _context.next = 8;\n            return axios.request(options);\n\n          case 8:\n            result = _context.sent;\n            DJIAdata = result.data.values;\n            searchDate = startDate;\n            console.log(startDate.date + ' is day ' + startDate.day());\n\n            if (startDate.day() === 6) {\n              //if it's a saturday\n              searchDate = startDate.subtract(1, \"days\");\n            } else if (startDate.day() === 0) {\n              //if it's a sunday\n              searchDate = startDate.subtract(2, \"days\");\n            }\n\n            console.log(searchDate);\n            dowOpening = _.find(DJIAdata, {\n              'datetime': moment(searchDate).format('YYYY-MM-DD')\n            });\n            return _context.abrupt(\"return\", 1);\n\n          case 16:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n  return _getDOW.apply(this, arguments);\n}\n\n;","map":{"version":3,"sources":["/Users/Neil/Projects/xkcd-geohashing/src/api/dow.js"],"names":["axios","moment","_","getDOW","date","endDate","today","format","daysBetween","startDate","diff","console","log","options","method","url","params","symbol","interval","outputsize","headers","request","result","DJIAdata","data","values","searchDate","day","subtract","dowOpening","find"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAOC,CAAP,MAAc,QAAd;AAEA,gBAAsBC,MAAtB;AAAA;AAAA;;;;;2BAAO,iBAAsBC,IAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AACL;AACA;AACA;AACIC,YAAAA,OAJC,GAISJ,MAAM,CAACG,IAAD,CAJf;AAKDE,YAAAA,KALC,GAKOL,MAAM,GAAGM,MAAT,CAAgB,YAAhB,CALP;AAMDC,YAAAA,WANC,GAMa,CAAC,CAAD,GAAKC,SAAS,CAACC,IAAV,CAAeJ,KAAf,EAAqB,MAArB,CAAL,GAAmC,CANhD;AAOLK,YAAAA,OAAO,CAACC,GAAR,CAAYJ,WAAZ;AACIK,YAAAA,OARC,GAQS;AACdC,cAAAA,MAAM,EAAE,KADM;AAEdC,cAAAA,GAAG,EAAE,iDAFS;AAGdC,cAAAA,MAAM,EAAE;AAACC,gBAAAA,MAAM,EAAE,KAAT;AAAgBC,gBAAAA,QAAQ,EAAE,MAA1B;AAAkCC,gBAAAA,UAAU,EAAEX,WAA9C;AAA2DD,gBAAAA,MAAM,EAAE;AAAnE,eAHM;AAIZa,cAAAA,OAAO,EAAE;AACP,kCAAkB,oDADX;AAEP,mCAAmB;AAFZ;AAJG,aART;AAkBLT,YAAAA,OAAO,CAACC,GAAR,CAAY,uBAAuBC,OAAO,CAACG,MAAR,CAAeG,UAAtC,GAAmD,OAA/D;AAlBK;AAAA,mBAoBcnB,KAAK,CAACqB,OAAN,CAAcR,OAAd,CApBd;;AAAA;AAoBDS,YAAAA,MApBC;AAqBDC,YAAAA,QArBC,GAqBUD,MAAM,CAACE,IAAP,CAAYC,MArBtB;AAsBDC,YAAAA,UAtBC,GAsBYjB,SAtBZ;AAuBLE,YAAAA,OAAO,CAACC,GAAR,CAAYH,SAAS,CAACL,IAAV,GAAiB,UAAjB,GAA8BK,SAAS,CAACkB,GAAV,EAA1C;;AACA,gBAAIlB,SAAS,CAACkB,GAAV,OAAoB,CAAxB,EAA0B;AAAE;AAC1BD,cAAAA,UAAU,GAAGjB,SAAS,CAACmB,QAAV,CAAmB,CAAnB,EAAsB,MAAtB,CAAb;AACD,aAFD,MAEM,IAAInB,SAAS,CAACkB,GAAV,OAAoB,CAAxB,EAA2B;AAAE;AACjCD,cAAAA,UAAU,GAAEjB,SAAS,CAACmB,QAAV,CAAmB,CAAnB,EAAsB,MAAtB,CAAZ;AACD;;AACDjB,YAAAA,OAAO,CAACC,GAAR,CAAYc,UAAZ;AAEIG,YAAAA,UA/BC,GA+BY3B,CAAC,CAAC4B,IAAF,CAAOP,QAAP,EAAiB;AAAC,0BAAWtB,MAAM,CAACyB,UAAD,CAAN,CAAmBnB,MAAnB,CAA0B,YAA1B;AAAZ,aAAjB,CA/BZ;AAAA,6CAgCE,CAhCF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AAiCN","sourcesContent":["import axios from 'axios';\nimport moment from 'moment';\nimport _ from 'lodash'\n\nexport async function getDOW(date){\n  // to adjust for different dates, the outputsize value needs to be adjusted accordingly.\n  // new code uses the twelvedata API server, which provides all the information I need\n  // plus I have rapidapi taking care of the overhead, which is nice\n  let endDate = moment(date);\n  let today = moment().format('YYYY-MM-DD')\n  let daysBetween = -1 * startDate.diff(today,\"days\") +1\n  console.log(daysBetween)\n  let options = {\n  method: 'GET',\n  url: 'https://twelve-data1.p.rapidapi.com/time_series',\n  params: {symbol: 'DJI', interval: '1day', outputsize: daysBetween, format: 'json'},\n    headers: {\n      'x-rapidapi-key': 'cc072cf6a1mshca7a9fff5bd7131p175ba7jsne97460d453d2',\n      'x-rapidapi-host': 'twelve-data1.p.rapidapi.com'\n    }\n  };\n\n  console.log('checking the past ' + options.params.outputsize + ' days')\n\n  let result = await axios.request(options)\n  let DJIAdata = result.data.values;\n  let searchDate = startDate;\n  console.log(startDate.date + ' is day ' + startDate.day())\n  if (startDate.day() === 6){ //if it's a saturday\n    searchDate = startDate.subtract(1, \"days\");\n  }else if (startDate.day() === 0) { //if it's a sunday\n    searchDate =startDate.subtract(2, \"days\");\n  }\n  console.log(searchDate)\n\n  let dowOpening = _.find(DJIAdata, {'datetime':moment(searchDate).format('YYYY-MM-DD')})\n  return 1\n};\n"]},"metadata":{},"sourceType":"module"}